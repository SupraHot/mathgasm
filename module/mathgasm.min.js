var __DATE__="Fri Mar 24 2017 14:23:50 GMT+0100 (CET)";console.log("Compiled at",__DATE__),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.mathgasm=e.mathgasm||{})}(this,function(e){"use strict";var t=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},n=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),i=function(){function e(){t(this,e)}return n(e,[{key:"__init",value:function(e){this.__initHeap(e.buffer)}},{key:"__initHeap",value:function(e){this.wasmMemoryBuffer=e,this.HEAP8=new Int8Array(e),this.HEAP16=new Int16Array(e),this.HEAP32=new Int32Array(e),this.HEAPU8=new Uint8Array(e),this.HEAPU16=new Uint16Array(e),this.HEAPU32=new Uint32Array(e),this.HEAPF32=new Float32Array(e),this.HEAPF64=new Float64Array(e),this.__initMalloc()}},{key:"__initMalloc",value:function(){this.HEAPU32[5]=0,this.HEAPU32[6]=0,this.HEAPU32[7]=0,this.HEAP32[2]=40,this.HEAP32[3]=40}},{key:"malloc",value:function(e){e|=0;var t=0,n=0,i=0,r=0,s=0;if(e=0|7+(0|e),t=8+(0|e)|0,(0|(n=0|this.getFreeChunk(0|t)))>0|0)return 0|n;for(i=0|7+(0|this.HEAP32[3]),r=(0|i)+(0|t)|0,s=4+(0|i)|0,this.setHeadSize(0|s,0|t),this.setInuse(4+(0|s)|0),this.setFoot(0|s,0|t),this.HEAP32[3]=4+(0|r)|0,i=0|8+(0|i),s=0|i;(0|s)<(0|r)|0;)this.HEAPU32[s>>2]=0,s=0|4+(0|s);return 0|i}},{key:"getFreeChunk",value:function(e){e|=0;var t=0;return(0|this.HEAPU32[5])>0|0&&(0|(t=0|this.findChunk(0|e)))>0|0?((0|t)==(0|this.HEAPU32[6])|0&&(this.HEAPU32[6]=0|this.nextFree(0|t)),(0|t)==(0|this.HEAPU32[7])|0&&(this.HEAPU32[7]=0),this.HEAPU32[5]=(0|this.HEAPU32[5])-1|0,this.setInuse(0|t),this.HEAPU32[4]=(0|this.HEAPU32[4])-(0|this.getChunkSize(0|t))|0,0|t):0}},{key:"setHeadSize",value:function(e,t){e|=0,t|=0,this.HEAPU32[e>>2]=0|7&(0|this.HEAPU32[e>>2])|t|0}},{key:"setInuse",value:function(e){e|=0;var t=0;t=(0|e)-4|0,this.HEAPU32[t>>2]=1|this.HEAPU32[t>>2]}},{key:"setFoot",value:function(e,t){e|=0,t|=0;var n=0,i=0;n=0|this.HEAPU32[e>>2],i=(0|e)+(0|n)|0,this.HEAPU32[i>>2]=0|t}},{key:"nextFree",value:function(e){return e|=0,0|this.HEAP32[e>>2]}},{key:"findChunk",value:function(e){e|=0;var t=0;for(t=0|this.HEAPU32[6];0!=(0|t)|0;){if((0|this.getChunkSize(0|t))==(0|e)|0)return 0|t;t=0|this.HEAPU32[t>>2]}return 0}},{key:"getFreeChunk",value:function(e){e|=0;var t=0;return(0|this.HEAPU32[5])>0|0&&(0|(t=0|this.findChunk(0|e)))>0|0?((0|t)==(0|HEAPU32[6])|0&&(this.HEAPU32[6]=0|this.nextFree(0|t)),(0|t)==(0|this.HEAPU32[7])|0&&(this.HEAPU32[7]=0),this.HEAPU32[5]=(0|this.HEAPU32[5])-1|0,this.setInuse(0|t),this.HEAPU32[4]=(0|this.HEAPU32[4])-(0|this.getChunkSize(0|t))|0,0|t):0}},{key:"getChunkSize",value:function(e){e|=0;var t=0;return t=(0|e)-4|0,(0|this.HEAPU32[t>>2])&-2|0}}]),e}(),r=new i;e.__Native={};var s=function(){function i(){t(this,i)}return n(i,[{key:"initialize",value:function(t,n){fetch(t).then(function(e){return e.arrayBuffer()}).then(function(e){return WebAssembly.compile(e)}).then(function(t){var n={env:{memoryBase:0,tableBase:0,memory:new WebAssembly.Memory({initial:256}),table:new WebAssembly.Table({initial:0,element:"anyfunc"}),DYNAMICTOP_PTR:0,tempDoublePtr:0,STACKTOP:8,STACK_MAX:8,ABORT:0,abortStackOverflow:function(){},_malloc:r.malloc.bind(r),_printf:function(e){console.log("log",e)}},global:{NaN:0,Infinity:0}},i=new WebAssembly.Instance(t,n);r.__init(n.env.memory),e.__Native=i.exports}).then(n)}}]),i}(),a=new s,o=function(){function i(e,n){t(this,i),this.x=e,this.y=n}return n(i,[{key:"add",value:function(t){console.log("heap pointer",e.__Native.getHeapPtr()),console.log("this",this),console.log("v",t);var n=e.__Native.new_mathgasm_float2(this.x,this.y),r=e.__Native.new_mathgasm_float2(t.x,t.y),s=e.__Native.mathgasm_float2_add(n,r);e.__Native.free(n),e.__Native.free(r);var a=e.__Native.memory.buffer,o=new Uint8Array(a,s,8),u=new Float32Array(o.buffer,o.byteOffset,2),h=new i(u[0],u[1]);return e.__Native.free(s),h}}]),i}();e.Vec2=o,e.Bootstrapper=a,e.Heap=r,Object.defineProperty(e,"__esModule",{value:!0})});